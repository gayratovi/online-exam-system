<!DOCTYPE html>
<html lang="en">
<head>
  <title>{{ exam.title }} — Attempt by {{ attempt.student.username }}</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:20px; }
    nav a { text-decoration:none; margin-left:10px; color:#0d6efd; }
    nav a:hover { text-decoration:underline; }
    .meta { margin: 8px 0 14px; padding: 12px; background:#f7f7f7; border-radius:8px; }
    .meta strong { font-weight:600; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
    th { background:#f7f7f7; text-align:left; }
    .correct { color: green; font-weight: 600; }
    .wrong { color: #a00; font-weight: 600; }
    .back a { text-decoration:none; color:#0d6efd; }
    .back a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  {% include "partials/staff_header.html" %}

  <h2>{{ exam.title }} — Attempt by {{ attempt.student.username }}</h2>

  <div class="meta">
    <div><strong>Status:</strong> {% if attempt.completed %}Completed{% else %}In Progress{% endif %}</div>
    <div><strong>Score:</strong> {% if attempt.completed %}{{ attempt.score }}%{% else %}—{% endif %}</div>
    <div><strong>Started:</strong> {{ attempt.started_at }}</div>
    <div><strong>Submitted:</strong> {% if attempt.submitted_at %}{{ attempt.submitted_at }}{% else %}—{% endif %}</div>
    <div><strong>Time taken:</strong> {{ time_taken }}</div>
  </div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Question</th>
        <th>Student Answer</th>
        <th>Correct Answer</th>
        <th>Result</th>
      </tr>
    </thead>
    <tbody>
      {% for a in answers %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ a.question.question_text }}</td>
        <td>{{ a.selected_answer }}</td>
        <td>{{ a.question.correct_answer }}</td>
        <td>
          {% if a.is_correct %}
            <span class="correct">✅ Correct</span>
          {% else %}
            <span class="wrong">❌ Wrong</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p class="back" style="margin-top:14px;">
    <a href="{% url 'staff_exam_results' exam.id %}">← Back to Results</a>
  </p>
</body>
</html>
