{% extends "base.html" %}

{% block title %}Change Password | CSSS{% endblock %}

{% block content %}
<section class="mx-auto" style="max-width: 400px;">
  <h2 class="mb-3">Change Password</h2>

  <form method="post" novalidate>
    {% csrf_token %}

    <!-- Show form errors -->
    {% if form.errors %}
      <div class="alert alert-danger">
        <ul class="mb-0">
          {% for field, errors in form.errors.items %}
            {% for error in errors %}
              <li><strong>{{ field|title }}</strong>: {{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="mb-3">
      <label for="{{ form.old_password.id_for_label }}" class="form-label">Current Password</label>
      <input type="password" name="{{ form.old_password.name }}" id="{{ form.old_password.id_for_label }}"
             class="form-control" required>
    </div>

    <div class="mb-3">
      <label for="{{ form.new_password1.id_for_label }}" class="form-label">New Password</label>
      <input type="password" name="{{ form.new_password1.name }}" id="{{ form.new_password1.id_for_label }}"
             class="form-control" required>
    </div>

    <div class="mb-3">
      <label for="{{ form.new_password2.id_for_label }}" class="form-label">Confirm New Password</label>
      <input type="password" name="{{ form.new_password2.name }}" id="{{ form.new_password2.id_for_label }}"
             class="form-control" required>
    </div>

    <button type="submit" class="btn btn-primary w-100">Update Password</button>
  </form>

  <p class="mt-3 text-center">
    {% if request.user.role == "student" %}
      <a href="{% url 'student_dashboard' %}">← Back to Dashboard</a>
    {% elif request.user.role == "staff" %}
      <a href="{% url 'staff_dashboard' %}">← Back to Dashboard</a>
    {% endif %}
  </p>
</section>
{% endblock %}
